<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Patrice Godard" />

<meta name="date" content="2022-01-14" />

<title>chTKCat user guide</title>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="libs/navigation-1.1/tabsets.js"></script>
<link href="libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">



<h1 class="title toc-ignore">chTKCat user guide</h1>
<h4 class="author">Patrice Godard</h4>
<h4 class="date">January 14, 2022</h4>

</div>


<div style="width:200px;">
<p><img src="libs/figs/TKCat.png" style="width:100.0%" /></p>
</div>
<div id="introduction" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>The aim of TKCat (Tailored Knowledge Catalog) is to facilitate the management of data from knowledge resources that are frequently used alone or together in research environments. In TKCat, knowledge resources are manipulated as modeled database (MDB) objects. These objects provide access to the data tables along with a general description of the resource and a detail data model generated with <a href="https://github.com/patzaw/ReDaMoR">ReDaMoR</a> documenting the tables, their fields and their relationships. These MDB are then gathered in catalogs that can be easily explored an shared. TKCat provides tools to easily subset, filter and combine MDBs and create new catalogs suited for specific needs.</p>
<p>The TKCat R package is licensed under <a href="https://www.gnu.org/licenses/gpl-3.0.en.html">GPL-3</a>.</p>
<p>This vignette describes how TKCat can be used with a <a href="https://clickhouse.com/">ClickHouse</a> database. Users should also refer to the <a href="TKCat-User-guide.html">general TKCat user guide</a>. Finally, a <a href="chTKCat-Operations-manual.html">specific vignette</a> describes how to create and administrate a TKCat ClickHouse instance, and another is dedicated to an <a href="TKCat-Collections.html">extended documentation of collections</a>.</p>
</div>
<div id="connection" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Connection</h1>
<p>The connection to a chTKCat database is achieved by instantiating <em>chTKCat</em> object.</p>
<pre class="r"><code>k &lt;- chTKCat(
   host=&quot;localhost&quot;, # default parameter
   port=9101L,       # default parameter
   user=&quot;default&quot;,   # default parameter
   password=&quot;&quot;       # if not provided the password is requested interactively 
)</code></pre>
<p>Connection parameters should be adapted according to the ClickHouse database setup which is documented in the web exploration interface (in the “System” tab).</p>
</div>
<div id="use" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Use</h1>
<p>The <em>chTKCat</em> object can be used as a <a href="TKCat-User-guide.html#local-tkcat"><em>TKCat</em> object</a>.</p>
<pre class="r"><code>list_MDBs(k)                     # list all the MDBs in a TKCat object
khpo &lt;- get_MDB(k, &quot;HPO&quot;)        # get a specific MDBs from the catalog
search_MDB_tables(k, &quot;disease&quot;)  # Search table about &quot;disease&quot;
search_MDB_fields(k, &quot;disease&quot;)  # Search a field about &quot;disease&quot;
collection_members(k)            # Get collection members of the different MDBs</code></pre>
<p>The <em>khpo</em> object in the example above is a <em>chMDB</em> object. The data of this type of MDB are located in the ClickHouse database until the user requests them. They can be use like any other <em>MDB</em> object:</p>
<ul>
<li><a href="TKCat-User-guide.html#getting-information">Getting information</a></li>
<li><a href="TKCat-User-guide.html#pulling-subsetting-and-combining">Pulling, subsetting and combining</a></li>
<li><a href="TKCat-User-guide.html#filtering-and-joining">Filtering and joining</a></li>
<li><a href="TKCat-User-guide.html#merging-with-collections">Merging using collections</a></li>
</ul>
<p>The user is able to access only <em>chMDB</em> allowed according to his rights (see the <a href="chTKCat-Operations-manual.html">operation manual</a>).</p>
</div>
<div id="reconnecting" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Reconnecting</h1>
<p>If the connection to the database is lost the user can reactivate it by using the <code>db_reconnect()</code> function which works with <em>chTKCat</em> objects but also with <em>chMDB</em> objects.</p>
</div>
<div id="pushing-an-mdb-in-a-chtkcat-instance" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Pushing an MDB in a chTKCat instance</h1>
<p>MDB can be add to the ClickHouse database of a <em>chTKCat</em> object with the <code>as_chMDB()</code> function.</p>
<pre class="r"><code>lk &lt;- TKCat(read_fileMDB(
   path=system.file(&quot;examples/ClinVar&quot;, package=&quot;TKCat&quot;)
))
names(lk)
as_chMDB(lk$ClinVar, k, overwrite=FALSE)</code></pre>
<p>This function works only if (see the <a href="chTKCat-Operations-manual.html">operation manual</a>):</p>
<ul>
<li>the <em>ClinVar</em> database has been initiated by the administrator of the ClickHouse database,</li>
<li>the user is allowed to write in the database.</li>
</ul>
</div>
<div id="acknowledgments" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Acknowledgments</h1>
<p>This work was entirely supported by <a href="https://www.ucb.com/">UCB Pharma</a> (Early Solutions department).</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
